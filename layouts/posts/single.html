{{ define "head" }}
    {{ partialCached "meta/inline-postcss.html" (resources.Get "css/pages/article.css") "css/pages/article.css" }}
    {{ if in .Content "<code>" }}
        {{ partialCached "meta/async-postcss.html" (resources.Get "css/highlight.css") "css/highlight.css" }}
    {{ end }}
    {{ partial "seo/blogposting.html" . }}
{{ end }}
{{ define "main" }}
    <article class="article">
        {{ $bkg := .Resources.GetMatch "background.*" }}
        <header class="card header article__header {{ if $bkg }}card--image{{ end }}"{{ if $bkg }} style='background-image:url({{$bkg.RelPermalink}})'{{ end }}>
            <div class="header__content inner">
                <div class="header__text">
                    <span class="date">
                        {{- if ne .Date .Lastmod -}}
                        Last updated on {{ partial "time.html" .Lastmod }}
                        {{- else -}}
                        Posted on {{ partial "time.html" .Date }}
                        {{- end -}}
                    </span>
                    <h1 class="block card__title">{{.Title}}</h1>
                    <p class="card__subtitle">{{.Description}}</p>
                    {{ partial "post/tag_list.html" . }}
                </div>

                {{ partial "project/buttons.html" (dict "links" .Params.links "page" .RelPermalink) }}
            </div>
        </header>

        {{ if .Params.toc }}
        {{ $jsOptions := dict "minify" true "target" "es2015" }}
        {{ $script := resources.Get "js/sticky.js" | js.Build $jsOptions | fingerprint }}
        <script src="{{ $script.RelPermalink }}" integrity="{{ $script.Data.Integrity }}" defer></script>

        <aside class="article__toc">
            <div class="article__toc-inner">
                <h2>Contents <a href="#" title="Back to top">â†¥</a></h2>
                {{ .TableOfContents }}
            </div>
        </aside>
        {{ end }}

        <div class="article__body inner">
            {{ .Content }}
        </div>

        {{ partial "cta_nav.html" . }}
    </article>
{{ end }}
