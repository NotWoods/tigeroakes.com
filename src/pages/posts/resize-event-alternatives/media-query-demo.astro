---
import IframeDemo from './IframeDemo.astro';
---

<IframeDemo title="Media query event count">
  <p>
    media query change handler executed: <span id="resizeCount">0</span> times (<span
      id="lastTime">1.0</span
    >ms since previous execution)
  </p>
  <p>iframe dimensions: <span id="windowDimensions">0x0</span></p>

  <style>
    p {
      @apply m-0;
    }
  </style>
  <script>
    const resizeCount = document.getElementById('resizeCount');
    const lastTime = document.getElementById('lastTime');
    const windowDimensions = document.getElementById('windowDimensions');

    let count = 0;
    let lastTimeMs = performance.now();

    window.addEventListener('resize', () => {
      windowDimensions.textContent = `${window.innerWidth}x${window.innerHeight}`;
    });

    const query = matchMedia('(max-width: 400px)');
    query.addEventListener('change', () => {
      const now = performance.now();
      count++;

      resizeCount.textContent = count.toString();
      lastTime.textContent = (now - lastTimeMs).toFixed(1);

      lastTimeMs = now;
    });
  </script>
</IframeDemo>
