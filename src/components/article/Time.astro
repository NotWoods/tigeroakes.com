---
import { Intl, Temporal } from '@js-temporal/polyfill';
import { dateFromString, formatToPartsMap } from '../../scripts/date';

export interface Props {
  date: string | Temporal.PlainDate;
}

const { date } = Astro.props as Props;
const readableFormatter = new Intl.DateTimeFormat('en-CA', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});

const parts = formatToPartsMap(
  readableFormatter,
  typeof date === 'string' ? dateFromString(date) : undefined
);
---

<time class="text-sm opacity-80" datetime={date.toString()}>
  <slot />
  {parts.get('year')}, {parts.get('month')}
  {parts.get('day')}
</time>
