---
import ListGrid, { Item } from "./ListGrid.astro";

export interface Props {
  items: readonly Item[];
}

const { items } = Astro.props as Props;

function groupByYear(): readonly { year: number, items: readonly Item[] }[] {
  const itemsByYear = new Map<number, Item[]>();
	for (const item of items) {
		const { year } = item.date;
		const posts = itemsByYear.get(year) ?? [];
		posts.push(item);
		itemsByYear.set(year, posts);
	}
	return Array.from(itemsByYear).map(([year, items]) => ({ year, items }));
}

---
{groupByYear().map(({ year, items }) => (
  <ListGrid title={year.toString()} items={items} />
))}
